<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="profile.css">
</head>
<body>
	<!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#projectCreationModal" >
  		Create New Project
	</button> -->

	<!--Project Creation Modal -->
	<div class="modal fade" id="projectCreationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h5 class="modal-title" id="exampleModalLongTitle">Add a New Project</h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<form id="uploadForm" action="/uploadFile" method="post" enctype="multipart/form-data" target="_self">
              <div class="form-group">
                <label for="projectTitle">Name Your Project</label>
                <input name="projectTitle" type="text" class="form-control" id="projectTitle" placeholder="Project Title">
              </div>
              <div class="form-group">
                <label for="projectDescription">What does your project show?</label>
                <input name="projectDescription" type="text" class="form-control" id="projectDescription" placeholder="Project Description">
              </div>
              <div class="form-group">
                <label for="image">Upload Image</label>
                <input type="file" name="image" id="image" class="form-control">
              </div>
              <input type="hidden" name="userId" id="userId">
              <input type="submit" class="btn btn-primary" id="submitProject">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
		    </form>
		  </div>
		</div>
	  </div>
	</div>

	<!--Project View Modal -->
	<div class="modal fade" id="projectViewModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h5 class="modal-title" id="exampleModalLongTitle"></h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div id="project-view-modal" class="modal-body">
		    <img src="" alt="Project Image" class="design-pics" id="projectImgModal">
            <p id="projectTitleModal"></p>
            <p id="projectDescriptionModal"></p>
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			<button type="button" class="btn btn-primary">Follow</button>
		  </div>
		</div>
	  </div>
	</div>



	<nav class="navbar navbar-expand-lg" id="nav">
   		<a class="navbar-brand" href="home.html">InLook</a>
   		<div class="collapse navbar-collapse" id="navbarSupportedContent">
   			<div class="input-group">
     			<input type="text" class="form-control" placeholder="Search...">
      			<span class="input-group-btn">
        			<button class="btn btn-default" type="button"><i class="fas fa-search"></i></button>
      			</span>
    		</div>
      		<ul class="navbar-nav ml-auto">
      			<li class="nav-item">
            		<a class="nav-link" href="profile.html" id="userName"><i class="fas fa-user-circle"></i> User </a>
         		</li>
         		<li class="nav-item">
            		<a class="nav-link" href="messages.html"><i class="far fa-envelope fa-lg"></i></a>
         		</li>
         		|
				<li class="nav-item">
					<a class="nav-link" href="login.html" id="logout"><i class="fas fa-sign-out-alt"></i></a>
				</li>
      		</ul>
   		</div>
	</nav>
	<div class="main">



	<!-- main content- bio, profile pic,
	following button, message button, project number, followers/following number-->
<div class="row">
	<div class="col-md-5 col-xs-3">
<div class="sidebar-profile-info">
	<!-- Profile essential details -->
	<div class="profile-important">
		<div class="profile-photo">
			<img src="profpic.png"  class="profpic" alt="">
		</div>
		<h3 class="username profileName" id="profileName">User</h3>
		<div class="bio">Hi, My name is <span class="profileName"></span>! Message me if you wanna work together!</div>
		<div class="profile-buttons">
			<button type="button" class="btn-sm-follow" id="followUser">Follow</button>
			<button type="button" class="btn-sm-message" id="messageButton">Message</button>
		</div>
	</div>

	<!-- Skills list -->
	<div class="sidebar-info-bar">
		<div class="profile-important">
			<h4>Skills & Styles </h4>
			<ul class="skills-list">
				<li>Modern</li>
				<li>Contemporary</li>
				<li>Rustic</li>
			</ul>
		</div>
	</div>
	<div class="sidebar-info-bar">
		<div class="profile-important">
			<h4>Social</h4>
			<div id="socialMedia">
			<a href="wwww.twitter.com" class="fa fa-twitter"></a>
			<a href="wwww.linkedin.com" class="fa fa-linkedin"></a>
			<a href="www.instagram.com" class="fa fa-instagram"></a>
		</div>

		</div>
	</div>
</div>
</div>

<!-- <div class="col-md-7 col-xs-9">
	<div class="project1" id="profileProjects">
		<img class="img-responsive" src="profile_interior.jpg" alt="">
		<img class="img-responsive" src="profile_interior.jpg" alt="">
		<img class="img-responsive" src="profile_interior.jpg" alt="">
		<img class="img-responsive" src="profile_interior.jpg" alt="">
	</div>
</div> -->

<div class="projects-main">
	<button type="button btn-sm" id="createProject" class="btn btn-primary" data-toggle="modal" data-target="#projectCreationModal" >
			<i class="fas fa-plus"></i>
	</button>
    <template class="projectTemplate">
      <div class="project">
		<div class="project-pic">
			<img src="interior_design4.jpg" alt="" class="design-pics" id="projectImg">
		</div>
        <p class="projectInfo" id="projectTitle"></p>
        <p class="projectInfo" id="projectDescription"></p>
        <p class="projectInfo" id="projectId"></p>
	</div>
    </template>
</div>
</div>
</div>
<button>Click me</button>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
  let projectClicked;
  
  $(document).ready(() => {
      
      $(document).on('click', 'button', function(){
        console.log($(this));
        $(this).hide();
      });
    
      $(document).on('click', 'img', () => {
                  //console.log($(this));
                  //$(this).hide();
                  $('#projectViewModal').modal();
                });
    
    
      //get userId and store in modal form field
      const userId = sessionStorage.getItem('id');
      $('#userId').val(userId);
      console.log("userId " + userId);
      const getUserProfileUrl = '/loadProfile/' + userId;
      console.log(getUserProfileUrl);
      $.ajax({
          url: getUserProfileUrl,
          type: 'GET',
          datatype: 'JSON',
          success: (data) => {
              console.log('Recieved user profile info');
              console.log(data);
              $('#userName')[0].childNodes[1].nodeValue = ' ' + data.firstName + ' ' + data.lastName;
              $('.profileName').html(data.firstName + ' ' + data.lastName);
          }
      });

      const getUserProjectsUrl = '/loadProjects/' + userId;
      $.ajax({
          url: getUserProjectsUrl,
          type: 'GET',
          datatype: 'JSON',
          success: (data) => {
              //console.log(data);
              if (data[0] != null) {
                const template = document.querySelector('.projectTemplate');
                const projectsMain = document.querySelector('.projects-main');

                for(let i = 0; i < data.length; i++) {
                  template.content.querySelector('.design-pics').src = data[i].mainImg;
                  template.content.querySelector('#projectTitle').textContent = data[i].projectTitle;
                  template.content.querySelector('#projectDescription').textContent = data[i].projectDescription;
                  template.content.querySelector('#projectId').textContent = data[i].projectId;
                  
                  console.log(data[i].mainImg);
                  let clone = document.importNode(template.content, true);
                  projectsMain.appendChild(clone);
                }
                
                /**
                $('.project').click(() => {
                                                      
                  $('#projectImgModal').attr('src', 'interior_design7.jpg'); //= "interior_design3.jpg";
                  console.log($(this).find('.design-pics').attr('src'));
                  console.log($(this).find('#projectTitle').text());
                  document.querySelector('.design-pics').src = $(this).find('.design-pics').attr('src');
                  
                  document.querySelector('#projectTitle').textContent = $(this).find('#projectTitle').text();
                  document.querySelector('#projectDescription').textContent = $(this).find('#projectDescription').text();
                  projectClicked = $(this).find('#projectId').text();
                  

                  $('#projectViewModal').modal();
                });
                */
                $(".design-pics").click(function(event){
                  //project div
                  projectDiv = $(event.target).parent().parent();
                  console.log($(event.target).parent().text());
                  console.log($(event.target).attr("src"));
                  $("#projectImgModal").attr("src", $(event.target).attr("src"));
                  console.log($(projectDiv).find('#projectTitle').text());
                  $('#projectTitleModal').text($(projectDiv).find('#projectTitle').text());
                  $('#projectDescriptionModal').text($(projectDiv).find('#projectDescription').text());     
                  
                });
//                $(document).on('click', 'img', () => {
//                  console.log($(this));
//                  $(this).hide();
//                  $('#projectViewModal').modal();
//                });

              }
          }
      });
      document.querySelector('#projectTitleModal').text = "Hello";
      $('#logout').click(() => {
          sessionStorage.clear();
          console.log(sessionStorage.getItem('id'));
      });

  });
  
</script>
 

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</body>
</html>
